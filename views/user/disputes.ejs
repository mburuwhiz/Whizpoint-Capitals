<div class="max-w-4xl mx-auto">
  <div class="mb-8">
    <h1 class="text-3xl font-extrabold text-gray-900 dark:text-white">Customer Support</h1>
    <p class="text-muted">Need help with a transaction? File a dispute or check your status.</p>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
    <div class="md:col-span-1 space-y-6">
      <nav class="card p-0 overflow-hidden">
        <a href="/profile" class="block px-6 py-4 text-gray-600 hover:bg-gray-50 border-l-4 border-transparent transition">
          <i class="fas fa-user-circle mr-2"></i> General
        </a>
        <a href="/profile/notifications" class="block px-6 py-4 text-gray-600 hover:bg-gray-50 border-l-4 border-transparent transition">
          <i class="fas fa-bell mr-2"></i> Notifications
        </a>
        <a href="/profile/disputes" class="block px-6 py-4 bg-primary-50 text-primary-600 font-bold border-l-4 border-primary-600">
          <i class="fas fa-gavel mr-2"></i> My Disputes
        </a>
        <a href="/verification" class="block px-6 py-4 text-gray-600 hover:bg-gray-50 border-l-4 border-transparent transition">
          <i class="fas fa-id-card mr-2"></i> Verification
        </a>
      </nav>

      <div class="card bg-primary-600 text-white border-none">
        <h4 class="font-bold mb-2">Need direct help?</h4>
        <p class="text-sm text-primary-100 mb-4">Our support team is available 24/7 for urgent issues.</p>
        <p class="font-bold"><i class="fas fa-envelope mr-2"></i> support@whizpoint.com</p>
      </div>
    </div>

    <div class="md:col-span-2 space-y-8">
      <!-- New Dispute Form -->
      <div class="card">
        <h3 class="text-xl font-bold mb-6">File a New Dispute</h3>
        <form action="/profile/disputes" method="POST" class="space-y-6">
          <input type="hidden" name="_csrf" value="<%= csrfToken %>">

          <div>
            <label class="block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2">Reason / Details</label>
            <textarea name="reason" required class="input-field" rows="4" placeholder="Describe the issue in detail..."></textarea>
          </div>

          <div>
            <label class="block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2">Transaction ID (Optional)</label>
            <input type="text" name="transactionId" class="input-field" placeholder="e.g. 5f9b...">
          </div>

          <button type="submit" class="btn btn-primary w-full py-3">
            Submit Dispute Request
          </button>
        </form>
      </div>

      <!-- Dispute List -->
      <div class="space-y-4">
        <h3 class="text-xl font-bold">Your Dispute History</h3>
        <% if (disputes.length === 0) { %>
          <div class="card py-12 text-center text-gray-500 italic">
            No active disputes found.
          </div>
        <% } %>
        <% disputes.forEach(d => { %>
          <div class="card">
            <div class="flex justify-between items-start mb-4">
              <span class="px-2 py-1 rounded text-[10px] font-bold uppercase <%= d.status === 'Open' ? 'bg-blue-100 text-blue-700' : (d.status === 'Resolved' ? 'bg-green-100 text-green-700' : 'bg-gray-100 text-gray-700') %>">
                <%= d.status %>
              </span>
              <span class="text-xs text-muted"><%= d.createdAt.toLocaleDateString() %></span>
            </div>
            <p class="font-medium mb-4 text-gray-900 dark:text-white"><%= d.reason %></p>
            <% if (d.adminResponse) { %>
              <div class="bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg border-l-4 border-primary-500">
                <p class="text-xs font-bold text-primary-600 uppercase tracking-widest mb-1">Official Response</p>
                <p class="text-sm text-gray-700 dark:text-gray-300"><%= d.adminResponse %></p>
              </div>
            <% } %>
          </div>
        <% }) %>
      </div>
    </div>
  </div>
</div>
